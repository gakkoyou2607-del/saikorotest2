<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>パスワード付き Python 実行（見やすく）</title>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
</head>
<body style="font-family: sans-serif; padding: 20px; background: #f0f0f0;">

  <h2>パスワードを入力</h2>
  <input type="password" id="pw" placeholder="パスワード">
  <button id="btnEnter">▶ 入る</button>

  <div id="main" style="display: none; margin-top: 30px; padding: 15px; background: #fff; border: 2px solid #888;">
    <h2>サイコロを振る</h2>
    <button id="btnRun">▶ 実行</button>
    <pre id="output"
         style="
           white-space: pre-wrap;
           background: #000;
           color: #fff;
           padding: 20px;
           margin-top: 15px;
           font-size: 1.4em;
           min-height: 50px;
           overflow-y: auto;
         ">
      <!-- 結果がここに表示されます -->
    </pre>
  </div>

  <script>
    const correctPw = "1234";

    document.getElementById("btnEnter").addEventListener("click", () => {
      const pw = document.getElementById("pw").value;
      if (pw === correctPw) {
        document.getElementById("main").style.display = "block";
        document.getElementById("pw").value = "";
        document.getElementById("pw").disabled = true;
        document.getElementById("btnEnter").disabled = true;
      } else {
        alert("パスワードが違います");
      }
    });

    let pyodideReady = loadPyodide();

    document.getElementById("btnRun").addEventListener("click", async () => {
      const pyodide = await pyodideReady;

      const code = `
import random
a = random.randrange(1, 7)
print("出た目は", a)
`;

      const outputElem = document.getElementById("output");
      outputElem.textContent = "";

      pyodide.setStdout(s => {
        outputElem.textContent += s + "\\n";
        outputElem.scrollTop = outputElem.scrollHeight;
      });

      try {
        await pyodide.runPythonAsync(code);
      } catch (err) {
        outputElem.textContent = "エラー: " + err;
      }
    });
  </script>

</body>
</html>
